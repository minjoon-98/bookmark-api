# ë¶ë§ˆí¬ ê´€ë¦¬ REST API

ê°œì¸ì´ ìì£¼ ë°©ë¬¸í•˜ëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë¶ë§ˆí¬ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
**íƒœê·¸ ê¸°ëŠ¥**ì„ í†µí•´ ë¶ë§ˆí¬ë¥¼ ë¶„ë¥˜í•˜ê³ , íƒœê·¸ë³„ë¡œ ë¹ ë¥´ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ëª©ì°¨
- [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [ë¹Œë“œ ë° ì‹¤í–‰ ë°©ë²•](#ë¹Œë“œ-ë°-ì‹¤í–‰-ë°©ë²•)
- [API ëª…ì„¸](#api-ëª…ì„¸)
- [í…ŒìŠ¤íŠ¸ ì‹¤í–‰](#í…ŒìŠ¤íŠ¸-ì‹¤í–‰)
- [ì£¼ìš” ì„¤ê³„ ì´ìœ ](#ì£¼ìš”-ì„¤ê³„-ì´ìœ )
- [ê°œì„ í•  ì ](#ê°œì„ í• -ì )

## ê¸°ìˆ  ìŠ¤íƒ
- **Language**: Java 21
- **Framework**: Spring Boot 3.5.7
- **Database**: H2 (In-Memory)
- **Build Tool**: Gradle
- **Test**: JUnit 5, Mockito, MockMvc
- **API Documentation**: Swagger/OpenAPI (SpringDoc)
- **CI**: GitHub Actions
- **Libraries**:
  - Spring Data JPA
  - Lombok
  - Validation

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/main/java/io/github/minjoon98/bookmark/
â”œâ”€â”€ config/              # ì„¤ì • í´ë˜ìŠ¤
â”‚   â””â”€â”€ OpenApiConfig.java
â”œâ”€â”€ controller/          # REST API ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â””â”€â”€ BookmarkController.java
â”œâ”€â”€ domain/              # ì—”í‹°í‹° í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ Bookmark.java
â”‚   â””â”€â”€ Tag.java
â”œâ”€â”€ dto/                 # DTO í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ request/
â”‚   â”‚   â”œâ”€â”€ BookmarkCreateRequest.java
â”‚   â”‚   â”œâ”€â”€ BookmarkUpdateRequest.java
â”‚   â”‚   â””â”€â”€ TagUpsertRequest.java
â”‚   â””â”€â”€ response/
â”‚       â”œâ”€â”€ BookmarkResponse.java
â”‚       â”œâ”€â”€ ErrorResponse.java
â”‚       â””â”€â”€ MessageResponse.java
â”œâ”€â”€ exception/           # ì˜ˆì™¸ ì²˜ë¦¬
â”‚   â”œâ”€â”€ BookmarkNotFoundException.java
â”‚   â””â”€â”€ GlobalExceptionHandler.java
â”œâ”€â”€ repository/          # JPA Repository
â”‚   â”œâ”€â”€ BookmarkRepository.java
â”‚   â””â”€â”€ TagRepository.java
â””â”€â”€ service/             # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    â”œâ”€â”€ BookmarkService.java         # ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤
    â””â”€â”€ BookmarkServiceImpl.java     # ì„œë¹„ìŠ¤ êµ¬í˜„ì²´
```

### íŒ¨í‚¤ì§€ êµ¬ì„± ì„¤ëª…
- **config**: Swagger/OpenAPI ì„¤ì • ë“± ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •
- **controller**: HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬, REST API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
- **domain**: ë°ì´í„°ë² ì´ìŠ¤ ì—”í‹°í‹° ì •ì˜
- **dto**: ìš”ì²­/ì‘ë‹µ ë°ì´í„° ì „ì†¡ ê°ì²´
- **exception**: ì˜ˆì™¸ í´ë˜ìŠ¤ ë° ì „ì—­ ì˜ˆì™¸ í•¸ë“¤ëŸ¬
- **repository**: ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ê³„ì¸µ
- **service**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬

## ë¹Œë“œ ë° ì‹¤í–‰ ë°©ë²•

### 1. ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Java 21 ì´ìƒ
- Git

### 2. í”„ë¡œì íŠ¸ í´ë¡ 
```bash
git clone <repository-url>
cd bookmark-api
```

### 3. ì‹¤í–‰ ë°©ë²•

#### Gradle ì‚¬ìš© (ê¶Œì¥)
```bash
# Windows
gradlew.bat bootRun

# Linux/Mac
./gradlew bootRun
```

#### JAR ë¹Œë“œ í›„ ì‹¤í–‰
```bash
# ë¹Œë“œ
./gradlew build

# ì‹¤í–‰
java -jar build/libs/bookmark-0.0.1-SNAPSHOT.jar
```

### 4. ì‹¤í–‰ í™•ì¸
ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ë‹¤ìŒ í¬íŠ¸ì—ì„œ ì ‘ì† ê°€ëŠ¥í•©ë‹ˆë‹¤:
- **ì• í”Œë¦¬ì¼€ì´ì…˜**: http://localhost:8080
- **Swagger UI**: http://localhost:8080/swagger-ui.html
- **H2 Console**: http://localhost:8080/h2-console
  - JDBC URL: `jdbc:h2:mem:bookmarkdb`
  - Username: `sa`
  - Password: (ê³µë°±)

## API ëª…ì„¸

### Swaggerë¥¼ í†µí•œ API ë¬¸ì„œ í™•ì¸
ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ í›„ **http://localhost:8080/swagger-ui.html** ì—ì„œ ì „ì²´ API ëª…ì„¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ğŸ“— ì •ì  API ëª…ì„¸ëŠ” [docs/api-spec.md](docs/api-spec.md) ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.


### ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸

| ê¸°ëŠ¥         | ë©”ì„œë“œ    | ì—”ë“œí¬ì¸íŠ¸                            | ì„¤ëª…                            |
| ---------- | ------ | -------------------------------- | ----------------------------- |
| ë¶ë§ˆí¬ ë“±ë¡     | POST   | `/bookmarks`                     | ìƒˆë¡œìš´ ë¶ë§ˆí¬ ì¶”ê°€                    |
| ë¶ë§ˆí¬ ëª©ë¡ ì¡°íšŒ  | GET    | `/bookmarks`                     | ì „ì²´ ì¡°íšŒ (ê²€ìƒ‰ `search`, í˜ì´ì§€ë„¤ì´ì…˜, ì •ë ¬ ì§€ì›) |
| ë¶ë§ˆí¬ ìƒì„¸ ì¡°íšŒ  | GET    | `/bookmarks/{id}`                | íŠ¹ì • ë¶ë§ˆí¬ ìƒì„¸                     |
| ë¶ë§ˆí¬ ìˆ˜ì •     | PUT    | `/bookmarks/{id}`                | ë¶ë§ˆí¬ ì •ë³´ ìˆ˜ì •                     |
| ë¶ë§ˆí¬ ì‚­ì œ     | DELETE | `/bookmarks/{id}`                | ë¶ë§ˆí¬ ì‚­ì œ                        |
| íƒœê·¸ë³„ ì¡°íšŒ | GET    | `/bookmarks/by-tag?name={tag}`   | í•´ë‹¹ íƒœê·¸ ë³´ìœ  ë¶ë§ˆí¬ í˜ì´ì§€ ì¡°íšŒ           |
| íƒœê·¸ ì¶”ê°€  | POST   | `/bookmarks/{id}/tags`           | ë¶ë§ˆí¬ì— íƒœê·¸ ëª©ë¡ ì¶”ê°€                 |
| íƒœê·¸ ì œê±°  | DELETE | `/bookmarks/{id}/tags/{tagName}` | ë¶ë§ˆí¬ì—ì„œ íƒœê·¸ ì œê±°                   |


---

## í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
./gradlew test
```

### í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
- **Repository Layer**: JPA ì¿¼ë¦¬ ë©”ì„œë“œ ë° CRUD í…ŒìŠ¤íŠ¸
- **Service Layer**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ì˜ˆì™¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ (Mockito)
- **Controller Layer**: REST API ì—”ë“œí¬ì¸íŠ¸ ë° ê²€ì¦ í…ŒìŠ¤íŠ¸ (MockMvc)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼ í™•ì¸
```bash
# í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸ëŠ” ë‹¤ìŒ ê²½ë¡œì—ì„œ í™•ì¸ ê°€ëŠ¥
build/reports/tests/test/index.html
```

## ì£¼ìš” ì„¤ê³„ ì´ìœ 

### 1. H2 In-Memory Database ì„ íƒ
**ì´ìœ **:
- ë³„ë„ì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜ ì—†ì´ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥
- ê°œë°œ ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¹ ë¥¸ ì´ˆê¸°í™”ì™€ ì¬ì‹œì‘
- ê³¼ì œ ì œì¶œ ì‹œ ì‹¤í–‰ í¸ì˜ì„± ê·¹ëŒ€í™”

**ì¥ì **:
- ì˜ì¡´ì„± ìµœì†Œí™”ë¡œ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì‹¤í–‰ ê°€ëŠ¥
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì–´ í…ŒìŠ¤íŠ¸ì— ìš©ì´

### 2. DTO íŒ¨í„´ ì‚¬ìš©
**ì´ìœ **:
- Entityì™€ API ì‘ë‹µì˜ ë¶„ë¦¬ë¥¼ í†µí•œ ê³„ì¸µ ê°„ ê²°í•©ë„ ê°ì†Œ
- API ìŠ¤í™ ë³€ê²½ ì‹œ ë„ë©”ì¸ ëª¨ë¸ì— ì˜í–¥ ìµœì†Œí™”
- ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ ë°©ì§€ ë° í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ì†¡

**êµ¬ì¡°**:
- `BookmarkCreateRequest`: ìƒì„± ì‹œ í•„ìˆ˜ ê°’ ê²€ì¦
- `BookmarkUpdateRequest`: ìˆ˜ì • ì‹œ ì„ íƒì  í•„ë“œ ì—…ë°ì´íŠ¸
- `BookmarkResponse`: í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•  ë°ì´í„°ë§Œ í¬í•¨

### 3. ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì„œë¹„ìŠ¤ ì„¤ê³„ (DIP)
**ì´ìœ **:
- ì˜ì¡´ì„± ì—­ì „ ì›ì¹™(Dependency Inversion Principle) ì ìš©
- ControllerëŠ” êµ¬ì²´ì ì¸ êµ¬í˜„ì²´ê°€ ì•„ë‹Œ Service ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ ë° êµ¬í˜„ì²´ êµì²´ ì‹œ ìœ ì—°ì„± í™•ë³´
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ëª…í™•í•œ ê³„ì•½(Contract) ì •ì˜

**êµ¬ì¡°**:
- `BookmarkService`: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¸í„°í˜ì´ìŠ¤
- `BookmarkServiceImpl`: ì‹¤ì œ êµ¬í˜„ì²´

### 4. ë‹¨ìˆœí•˜ê³  ì§ê´€ì ì¸ REST API ì‘ë‹µ í˜•ì‹
**ì´ìœ **:
- ì„±ê³µ ì‘ë‹µ: ë°ì´í„°ë¥¼ ì§ì ‘ ë°˜í™˜ (ë¶ˆí•„ìš”í•œ ë˜í¼ ì—†ìŒ)
- ì‚­ì œ ì‘ë‹µ: `MessageResponse`ë¡œ ëª…í™•í•œ ë©”ì‹œì§€ ì „ë‹¬
- ì‚°ì—… í‘œì¤€(Mozilla, Toss ë“±)ì„ ë”°ë¥¸ ì§ê´€ì ì¸ ì‘ë‹µ ì„¤ê³„

**ì‘ë‹µ í˜•ì‹**:
- ìƒì„±/ì¡°íšŒ/ìˆ˜ì •: ë°ì´í„° ì§ì ‘ ë°˜í™˜
- ì‚­ì œ: `{"message": "..."}`
- ì—ëŸ¬: `ErrorResponse` (ë©”ì‹œì§€, ìƒíƒœ, íƒ€ì„ìŠ¤íƒ¬í”„, ìƒì„¸ ì˜¤ë¥˜)

### 5. @RestControllerAdviceë¥¼ í†µí•œ ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬
**ì´ìœ **:
- ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì¼ê´€ëœ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹ ì œê³µ
- ì¤‘ë³µ ì½”ë“œ ì œê±° ë° ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- HTTP ìƒíƒœ ì½”ë“œì™€ ì—ëŸ¬ ë©”ì‹œì§€ì˜ í‘œì¤€í™”

**ì²˜ë¦¬ ì˜ˆì™¸**:
- `BookmarkNotFoundException`: 404 ì‘ë‹µ
- `MethodArgumentNotValidException`: 400 ì‘ë‹µ (í•„ë“œë³„ ê²€ì¦ ì˜¤ë¥˜)
- `Exception`: 500 ì‘ë‹µ (ì˜ˆìƒì¹˜ ëª»í•œ ì„œë²„ ì˜¤ë¥˜)

### 6. ìºì‹± ì „ëµ (Caffeine ê¸°ë°˜)

**ì´ìœ :**
- ë¶ë§ˆí¬ ì„œë¹„ìŠ¤ëŠ” ì½ê¸° ë¹„ì¤‘ì´ ë§¤ìš° ë†’ì•„, ì¡°íšŒ ì†ë„ ìµœì í™”ê°€ í•„ìš”í•¨.
- ë‹¨ê±´Â·ëª©ë¡Â·íƒœê·¸ë³„ ì¡°íšŒì˜ ë°˜ë³µ ìš”ì²­ì„ ì¤„ì´ê¸° ìœ„í•´ Spring Cache ì ìš©.

**êµ¬í˜„:**
- `CaffeineCacheManager` ê¸°ë°˜ ë¡œì»¬ ì¸ë©”ëª¨ë¦¬ ìºì‹œ.
- KeyGenerator ë¹ˆ(`pageableKeyGenerator`, `searchKeyGenerator`, `tagSearchKeyGenerator`)ì„ í†µí•´ ìºì‹œ í‚¤ ìë™ ìƒì„±.
- Look-aside ì „ëµìœ¼ë¡œ ìºì‹œ ë¯¸ìŠ¤ ì‹œ DB ì¡°íšŒ í›„ ìºì‹œ ì ì¬.
- ìƒì„±Â·ìˆ˜ì •Â·ì‚­ì œ ì‹œ ê´€ë ¨ ìºì‹œ ìë™ ë¬´íš¨í™”.

> ğŸ“˜ ìì„¸í•œ TTL, ìºì‹œ ì •ì±…, í‚¤ ì„¤ê³„ ë“±ì€ [docs/cache-design.md](docs/cache-design.md) ì°¸ê³ 


## ê°œì„ í•  ì 

## ë¼ì´ì„ ìŠ¤
ë³¸ í”„ë¡œì íŠ¸ëŠ” KRAFTON Intra Platform Team ë°±ì—”ë“œ ê°œë°œì ì±„ìš© ê³¼ì œë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
